<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoodFutures - Home</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="cursor-glow"></div>
    
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html" class="logo-text">FoodFutures</a>
                <div class="logo-pulse"></div>
            </div>
            
            <div class="nav-menu">
                <a href="index.html" class="nav-link active">Home</a>
                <a href="mrkt.html" class="nav-link">Markets</a>
                <a href="#about" class="nav-link">About</a>
                <a href="#contact" class="nav-link">Contact</a>
            </div>
            
            <div class="nav-actions">
                <div class="language-toggle">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="ko">한국어</button>
                </div>
                <a href="dsh.html" class="nav-btn">Dashboard</a>
                <button class="nav-btn" id="logoutBtn">Logout</button>
            </div>
        </div>
    </nav>

    <main class="home-main">
        <section class="hero-section">
            <h1 class="hero-title">Trade the Future of Food.</h1>
            <p class="hero-subtitle">Invest in a sustainable tomorrow with agricultural commodities.</p>
            <div class="hero-actions">
                <a href="mrkt.html" class="btn btn-primary">Start Trading Now</a>
                <a href="dsh.html" class="btn btn-secondary">View Dashboard</a>
            </div>
        </section>

        <section class="intro-section">
            <div class="intro-card">
                <h2 class="section-title">What is FoodFutures?</h2>
                <p>FoodFutures is a platform for trading agricultural commodities, allowing you to invest in a market that's essential for our future. Our real-time price simulations, driven by market data, provide a safe environment to learn and practice trading without real financial risk.</p>
            </div>
        </section>
        
        <section class="sample-position-section">
            <div class="section-header">
                <h2 class="section-title">Sample Market Position</h2>
            </div>
            <div class="position-card">
                <div class="position-info">
                    <span class="position-symbol">WHEAT</span>
                    <span class="position-name">Wheat</span>
                </div>
                <div class="position-details">
                    <div class="detail-item">
                        <span class="detail-label">Quantity</span>
                        <span class="detail-value" id="sampleQuantity">100.00</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Current Price</span>
                        <span class="detail-value" id="sampleCurrentPrice">$0.00</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">P/L ($)</span>
                        <span class="detail-value" id="sampleProfitLoss">$0.00</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">P/L (%)</span>
                        <span class="detail-value" id="sampleProfitLossPercent">0.00%</span>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    localStorage.removeItem('isLoggedIn');
                    window.location.href = 'index.html';
                });
            }

            // Function to sync the sample position with live market data
            function syncSamplePosition() {
                const marketData = JSON.parse(localStorage.getItem('marketData')) || [];
                const wheatMarket = marketData.find(m => m.symbol === 'WHEAT');

                if (!wheatMarket) {
                    // Initialize a sample position if market data is not available
                    const sampleTradeHistory = [{
                        id: 'sample_trade',
                        symbol: 'WHEAT',
                        name: 'Wheat',
                        action: 'buy',
                        quantity: 100,
                        price: 7.25,
                        timestamp: new Date().toISOString()
                    }];
                    localStorage.setItem('tradeHistory', JSON.stringify(sampleTradeHistory));
                    localStorage.setItem('marketData', JSON.stringify([
                         { id: 1, symbol: 'WHEAT', name: 'Wheat', category: 'grains', basePrice: 7.25, volatility: 0.15, price: 7.25, change: 0 },
                         { id: 2, symbol: 'CORN', name: 'Corn', category: 'grains', basePrice: 5.80, volatility: 0.12, price: 5.80, change: 0 }
                    ]));
                    console.log('Sample position and initial market data created in localStorage.');
                    return;
                }

                const sampleTradeHistory = JSON.parse(localStorage.getItem('tradeHistory')) || [];
                const sampleTrade = sampleTradeHistory.find(trade => trade.symbol === 'WHEAT');
                
                if (sampleTrade) {
                    const currentPrice = wheatMarket.price;
                    const initialPrice = sampleTrade.price;
                    const quantity = sampleTrade.quantity;

                    const currentValue = currentPrice * quantity;
                    const initialValue = initialPrice * quantity;
                    const profitLoss = currentValue - initialValue;
                    const profitLossPercent = (profitLoss / initialValue) * 100;
                    
                    const profitLossClass = profitLoss >= 0 ? 'positive' : 'negative';

                    document.getElementById('sampleCurrentPrice').textContent = `$${currentPrice.toFixed(2)}`;
                    document.getElementById('sampleQuantity').textContent = quantity.toFixed(2);
                    document.getElementById('sampleProfitLoss').textContent = `$${profitLoss.toFixed(2)}`;
                    document.getElementById('sampleProfitLoss').className = `detail-value ${profitLossClass}`;
                    document.getElementById('sampleProfitLossPercent').textContent = `${profitLoss >= 0 ? '+' : ''}${profitLossPercent.toFixed(2)}%`;
                    document.getElementById('sampleProfitLossPercent').className = `detail-value ${profitLossClass}`;
                } else {
                    console.error('Sample trade not found in trade history.');
                }
            }

            // Initial sync and then set an interval for continuous updates
            syncSamplePosition();
            setInterval(syncSamplePosition, 5000);
        });
    </script>
</body>
</html>
